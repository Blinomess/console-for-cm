# console-for-cm
<hr>
<h2>Краткое описание</h2> 
<p>Создан эмулятор командной строки с поддержкой виртуальной файловой системы (VFS), загружаемой из JSON-файла. Реализованы основные команды для работы с файлами, директориями, правами доступа и системными утилитами.</p> 
<p>Эмулятор поддерживает два режима работы: интерактивный режим с вводом команд пользователем и режим выполнения скриптов из файла. Все операции производятся в памяти, изменения VFS могут сохраняться обратно в JSON-файл.</p>
<h2>Методы класса ComLineEm</h2> 
<ol> 
  <li>__init__</li> 
  <li>run</li>
  <li>parse_command_line</li> 
  <li>load_script</li> 
  <li>ls</li> 
  <li>cd</li> 
  <li>cat</li> 
  <li>cal</li> 
  <li>chmod</li> 
  <li>mv</li>  
</ol> 
<hr> 
<h3>__init__</h3> 
<p>Инициализирует эмулятор командной строки. Устанавливает начальные параметры: текущий путь, пользователь системы, имя хоста, пути к VFS и скрипту. Загружает VFS из JSON-файла если указан путь.</p> 
<h3>run</h3> 
<p>Основной цикл выполнения эмулятора. Обрабатывает ввод пользователя в интерактивном режиме или выполняет команды из скрипта. Отображает отладочную информацию о параметрах запуска и управляет завершением работы.</p> 
<h3>parse_command_line</h3> <p>Парсит командную строку с учетом кавычек. Разделяет аргументы, заключенные в двойные или одинарные кавычки, на отдельные элементы списка.</p> 
<h3>load_script</h3> 
<p>Загружает команды из внешнего файла скрипта. Пропускает пустые строки и комментарии (начинающиеся с #). Устанавливает режим выполнения скрипта с остановкой при первой ошибке.</p> 
<h3>ls</h3> 
<p>Отображает содержимое директории. Поддерживает опцию `-l` для подробного вывода с правами доступа, владельцем и размером файлов. Работает как с VFS, так и в режиме эмуляции.</p> 
<h3>cd</h3> 
<p>Изменяет текущую рабочую директорию. Поддерживает абсолютные и относительные пути. Проверяет существование пути и то, что целевой объект является директорией.</p> 
<h3>cat</h3> 
<p>Выводит содержимое файла на экран. Поддерживает автоматическое декодирование данных в формате base64. Проверяет существование файла и то, что целевой объект не является директорией.</p> 
<h3>cal</h3> 
<p>Отображает календарь. Поддерживает различные форматы вывода: текущий месяц, весь год или конкретный месяц и год. Валидирует входные параметры.</p> 
<h3>chmod</h3>
<p>Изменяет права доступа к файлам и директориям. Поддерживает стандартную цифровую нотацию прав (755, 644 и т.д.). Проверяет корректность формата прав и существование целевого пути.</p> 
<h3>mv</h3> 
<p>Перемещает или переименовывает файлы и директории внутри VFS. Сохраняет изменения обратно в JSON-файл. Проверяет существование исходного пути и отсутствие конфликтов с целевым путем.</p> 
<hr> 
<h2>Методы класса VFS</h2>
<ol>
  <li>__init__</li>
  <li>load</li>
  <li>save</li>
  <li>init_permissions</li> 
  <li>get_file</li> 
  <li>list_dir</li> 
  <li>path_exists</li>
  <li>is_dir</li>
  <li>get_permissions</li> 
  <li>set_permissions</li> 
  <li>move_file</li> 
  <li>get_parent</li>
</ol> 
<hr> 
<h3>__init__</h3> 
<p>Инициализирует виртуальную файловую систему. Создает структуры для хранения файловой системы, прав доступа и метаданных.</p>
<h3>load</h3> 
<p>Загружает VFS из JSON-файла. Выполняет валидацию структуры данных, проверяет существование файла и корректность JSON-формата. Инициализирует права доступа по умолчанию.</p> 
<h3>save</h3> 
<p>Сохраняет текущее состояние VFS обратно в JSON-файл. Записывает структуру файловой системы с форматированием для удобства чтения.</p>
<h3>init_permissions</h3> 
<p>Инициализирует права доступа для всех элементов VFS. Устанавливает права 755 для директорий и 644 для файлов. Рекурсивно обходит всю структуру файловой системы.</p> 
<h3>get_file</h3> 
<p>Получает содержимое файла из VFS. Автоматически декодирует данные в формате base64. Возвращает содержимое как строку или сообщение об ошибке.</p> 
<h3>list_directory</h3> 
<p>Возвращает список содержимого директории. Поддерживает два режима: простой список имен или детальная информация с метаданными.</p>
<h3>path_exists</h3>
<p>Проверяет существование пути в VFS. Рекурсивно обходит структуру файловой системы для поиска указанного пути.</p>
<h3>is_dir</h3> 
<p>Определяет, является ли указанный путь директорией. Проверяет тип объекта в структуре VFS.</p>
<h3>get_permissions</h3> 
<p>Возвращает права доступа для указанного пути. Если права не установлены явно, возвращает значения по умолчанию в зависимости от типа объекта.</p>
<h3>set_permissions</h3> 
<p>Устанавливает права доступа для указанного пути. Сохраняет новые права в словаре прав доступа VFS.</p> 
<h3>move_file</h3> 
<p>Перемещает или переименовывает файл/директорию в VFS. Обновляет структуру файловой системы и переносит связанные метаданные (права доступа).</p> 
<h3>get_parent</h3> 
<p>Вспомогательный метод для получения родительского объекта по указанному пути. Используется для навигации по структуре VFS.</p>
<hr> 
<h2>Дополнительные функции</h2> 
<ol> 
  <li>parse_arguments</li>
  <li>args_handler</li>
</ol> 
<hr> 
<h3>parse_arguments</h3> 
<p>Парсит аргументы командной строки ОС. Поддерживает параметры --vfs для указания пути к VFS и --script для указания пути к стартовому скрипту.</p>
<h3>args_handler</h3>
<p>Обрабатывает аргументы командной строки с учетом кавычек. Разделяет аргументы, заключенные в кавычки, на отдельные элементы.</p>
<hr> 
<h2>Особенности реализации</h2> 
<p>Эмулятор полностью работает в памяти, не модифицируя реальную файловую систему. VFS загружается из JSON-файла, где бинарные данные кодируются в base64. Поддерживается остановка выполнения скрипта при первой ошибке. Все изменения VFS могут сохраняться обратно в исходный JSON-файл.</p>